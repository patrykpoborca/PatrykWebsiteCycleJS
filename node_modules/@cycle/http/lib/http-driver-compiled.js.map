{"version":3,"sources":["http-driver.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,IAAI,QAAQ,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;;AAEtC,IAAI,EAAE,GAAG,QAAQ,CAAC,EAAE,CAAC;;AAErB,IAAI,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;;AAEvC,SAAS,mBAAmB,CAAC,IAAI,EAAE;AACjC,MAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;AACnB,MAAI,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC;AAC1B,MAAI,IAAI,GAAG,SAAS,KAAK,SAAS,GAAG,IAAI,GAAG,SAAS,CAAC;AACtD,MAAI,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC;AAC9B,MAAI,MAAM,GAAG,WAAW,KAAK,SAAS,GAAG,IAAI,GAAG,WAAW,CAAC;AAC5D,MAAI,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC;AAC5B,MAAI,KAAK,GAAG,UAAU,KAAK,SAAS,GAAG,IAAI,GAAG,UAAU,CAAC;AACzD,MAAI,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC;AAC1B,MAAI,IAAI,GAAG,SAAS,KAAK,SAAS,GAAG,IAAI,GAAG,SAAS,CAAC;AACtD,MAAI,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC;AAClC,MAAI,QAAQ,GAAG,aAAa,KAAK,SAAS,GAAG,IAAI,GAAG,aAAa,CAAC;AAClE,MAAI,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC;AAC5B,MAAI,KAAK,GAAG,UAAU,KAAK,SAAS,GAAG,IAAI,GAAG,UAAU,CAAC;AACzD,MAAI,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC;AAC9B,MAAI,MAAM,GAAG,WAAW,KAAK,SAAS,GAAG,IAAI,GAAG,WAAW,CAAC;AAC5D,MAAI,oBAAoB,GAAG,IAAI,CAAC,eAAe,CAAC;AAChD;AACA,iBAAe,GAAG,oBAAoB,KAAK,SAAS,GAAG,KAAK,GAAG,oBAAoB,CAAC;AACpF,MAAI,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC;AAChC,MAAI,OAAO,GAAG,YAAY,KAAK,SAAS,GAAG,EAAE,GAAG,YAAY,CAAC;AAC7D,MAAI,cAAc,GAAG,IAAI,CAAC,SAAS,CAAC;AACpC,MAAI,SAAS,GAAG,cAAc,KAAK,SAAS,GAAG,CAAC,GAAG,cAAc,CAAC;AAClE,MAAI,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC;AAC1B,MAAI,IAAI,GAAG,SAAS,KAAK,SAAS,GAAG,MAAM,GAAG,SAAS,CAAC;AACxD,MAAI,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC;AAC9B,MAAI,MAAM,GAAG,WAAW,KAAK,SAAS,GAAG,KAAK,GAAG,WAAW,CAAC;;AAE7D,MAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;AAC3B,UAAM,IAAI,KAAK,CAAC,yDAAyD,CAAC,CAAC;GAC5E;AACD,MAAI,eAAe,GAAG,MAAM,CAAC,WAAW,EAAE,CAAC;AAC3C,MAAI,OAAO,GAAG,UAAU,CAAC,eAAe,CAAC,CAAC,GAAG,CAAC,CAAC;AAC/C,MAAI,OAAO,OAAO,CAAC,SAAS,KAAK,UAAU,EAAE;AAC3C,WAAO,GAAG,OAAO,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;GACxC;AACD,SAAO,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC7B,MAAI,IAAI,KAAK,IAAI,EAAE;AACjB,WAAO,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;GAC9B;AACD,MAAI,MAAM,KAAK,IAAI,EAAE;AACnB,WAAO,GAAG,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;GAClC;AACD,MAAI,KAAK,KAAK,IAAI,EAAE;AAClB,WAAO,GAAG,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;GAChC;AACD,MAAI,eAAe,EAAE;AACnB,WAAO,GAAG,OAAO,CAAC,eAAe,EAAE,CAAC;GACrC;AACD,MAAI,IAAI,KAAK,IAAI,IAAI,QAAQ,KAAK,IAAI,EAAE;AACtC,WAAO,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;GACxC;AACD,OAAK,IAAI,GAAG,IAAI,OAAO,EAAE;AACvB,QAAI,OAAO,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;AAC/B,aAAO,GAAG,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;KAC1C;GACF;AACD,MAAI,KAAK,KAAK,IAAI,EAAE;AAClB,SAAK,IAAI,GAAG,IAAI,KAAK,EAAE;AACrB,UAAI,KAAK,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;AAC7B,eAAO,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;OAC1C;KACF;GACF;AACD,MAAI,MAAM,KAAK,IAAI,EAAE;AACnB,SAAK,IAAI,CAAC,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;AAC3C,UAAI,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;AAClB,aAAO,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC;KACtD;GACF;AACD,SAAO,OAAO,CAAC;CAChB;;AAED,SAAS,eAAe,CAAC,GAAG,EAAE;AAC5B,SAAO,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;CAC5B;;AAED,SAAS,eAAe,CAAC,UAAU,EAAE;AACnC,SAAO,EAAE,CAAC,UAAU,CAAC,MAAM,CAAC,UAAU,QAAQ,EAAE;AAC9C,QAAI,OAAO,GAAG,SAAS,CAAC;AACxB,QAAI,OAAO,UAAU,KAAK,QAAQ,EAAE;AAClC,aAAO,GAAG,eAAe,CAAC,UAAU,CAAC,CAAC;KACvC,MAAM,IAAI,OAAO,UAAU,KAAK,QAAQ,EAAE;AACzC,aAAO,GAAG,mBAAmB,CAAC,UAAU,CAAC,CAAC;KAC3C,MAAM;AACL,cAAQ,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,uCAAuC,GAAG,iEAAiE,CAAC,CAAC,CAAC;AACzI,aAAO,YAAY,EAAE,CAAC;KACvB;;AAED,QAAI;AACF,aAAO,CAAC,GAAG,CAAC,UAAU,GAAG,EAAE,GAAG,EAAE;AAC9B,YAAI,GAAG,EAAE;AACP,kBAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;SACvB,MAAM;AACL,kBAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;AACrB,kBAAQ,CAAC,WAAW,EAAE,CAAC;SACxB;OACF,CAAC,CAAC;KACJ,CAAC,OAAO,GAAG,EAAE;AACZ,cAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;KACvB;;AAED,WAAO,SAAS,SAAS,GAAG;AAC1B,aAAO,CAAC,KAAK,EAAE,CAAC;KACjB,CAAC;GACH,CAAC,CAAC;CACJ;;AAED,SAAS,cAAc,GAAG;AACxB,MAAI,KAAK,GAAG,SAAS,CAAC,MAAM,IAAI,CAAC,IAAI,SAAS,CAAC,CAAC,CAAC,KAAK,SAAS,GAAG,EAAE,aAAa,EAAE,IAAI,EAAE,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;;AAEzG,MAAI,mBAAmB,GAAG,KAAK,CAAC,aAAa,CAAC;AAC9C,MAAI,aAAa,GAAG,mBAAmB,KAAK,SAAS,GAAG,IAAI,GAAG,mBAAmB,CAAC;;AAEnF,SAAO,SAAS,UAAU,CAAC,QAAQ,EAAE;AACnC,QAAI,UAAU,GAAG,QAAQ,CAAC,GAAG,CAAC,UAAU,UAAU,EAAE;AAClD,UAAI,SAAS,GAAG,eAAe,CAAC,UAAU,CAAC,CAAC;AAC5C,UAAI,aAAa,EAAE;AACjB,iBAAS,GAAG,SAAS,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;AACtC,iBAAS,CAAC,OAAO,EAAE,CAAC;OACrB;AACD,eAAS,CAAC,OAAO,GAAG,UAAU,CAAC;AAC/B,aAAO,SAAS,CAAC;KAClB,CAAC,CAAC;AACH,QAAI,aAAa,EAAE;AACjB,gBAAU,GAAG,UAAU,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;AACxC,gBAAU,CAAC,OAAO,EAAE,CAAC;KACtB;AACD,WAAO,UAAU,CAAC;GACnB,CAAC;CACH;;AAED,MAAM,CAAC,OAAO,GAAG;AACf,qBAAmB,EAAE,mBAAmB;AACxC,iBAAe,EAAE,eAAe;AAChC,iBAAe,EAAE,eAAe;;AAEhC,gBAAc,EAAE,cAAc;CAC/B,CAAC","file":"http-driver-compiled.js","sourcesContent":["\"use strict\";\n\nvar _require = require(\"@cycle/core\");\n\nvar Rx = _require.Rx;\n\nvar superagent = require(\"superagent\");\n\nfunction optionsToSuperagent(_ref) {\n  var url = _ref.url;\n  var _ref$send = _ref.send;\n  var send = _ref$send === undefined ? null : _ref$send;\n  var _ref$accept = _ref.accept;\n  var accept = _ref$accept === undefined ? null : _ref$accept;\n  var _ref$query = _ref.query;\n  var query = _ref$query === undefined ? null : _ref$query;\n  var _ref$user = _ref.user;\n  var user = _ref$user === undefined ? null : _ref$user;\n  var _ref$password = _ref.password;\n  var password = _ref$password === undefined ? null : _ref$password;\n  var _ref$field = _ref.field;\n  var field = _ref$field === undefined ? null : _ref$field;\n  var _ref$attach = _ref.attach;\n  var attach = _ref$attach === undefined ? null : _ref$attach;\n  var _ref$withCredentials = _ref.withCredentials;\n  var // if valid, should be an array\n  withCredentials = _ref$withCredentials === undefined ? false : _ref$withCredentials;\n  var _ref$headers = _ref.headers;\n  var headers = _ref$headers === undefined ? {} : _ref$headers;\n  var _ref$redirects = _ref.redirects;\n  var redirects = _ref$redirects === undefined ? 5 : _ref$redirects;\n  var _ref$type = _ref.type;\n  var type = _ref$type === undefined ? \"json\" : _ref$type;\n  var _ref$method = _ref.method;\n  var method = _ref$method === undefined ? \"get\" : _ref$method;\n\n  if (typeof url !== \"string\") {\n    throw new Error(\"Please provide a `url` property in the request options.\");\n  }\n  var sanitizedMethod = method.toLowerCase();\n  var request = superagent[sanitizedMethod](url);\n  if (typeof request.redirects === \"function\") {\n    request = request.redirects(redirects);\n  }\n  request = request.type(type);\n  if (send !== null) {\n    request = request.send(send);\n  }\n  if (accept !== null) {\n    request = request.accept(accept);\n  }\n  if (query !== null) {\n    request = request.query(query);\n  }\n  if (withCredentials) {\n    request = request.withCredentials();\n  }\n  if (user !== null && password !== null) {\n    request = request.auth(user, password);\n  }\n  for (var key in headers) {\n    if (headers.hasOwnProperty(key)) {\n      request = request.set(key, headers[key]);\n    }\n  }\n  if (field !== null) {\n    for (var key in field) {\n      if (field.hasOwnProperty(key)) {\n        request = request.field(key, field[key]);\n      }\n    }\n  }\n  if (attach !== null) {\n    for (var i = attach.length - 1; i >= 0; i--) {\n      var a = attach[i];\n      request = request.attach(a.name, a.path, a.filename);\n    }\n  }\n  return request;\n}\n\nfunction urlToSuperagent(url) {\n  return superagent.get(url);\n}\n\nfunction createResponse$(reqOptions) {\n  return Rx.Observable.create(function (observer) {\n    var request = undefined;\n    if (typeof reqOptions === \"string\") {\n      request = urlToSuperagent(reqOptions);\n    } else if (typeof reqOptions === \"object\") {\n      request = optionsToSuperagent(reqOptions);\n    } else {\n      observer.onError(new Error(\"Observable of requests given to HTTP \" + \"Driver must emit either URL strings or objects with parameters.\"));\n      return function () {}; // noop\n    }\n\n    try {\n      request.end(function (err, res) {\n        if (err) {\n          observer.onError(err);\n        } else {\n          observer.onNext(res);\n          observer.onCompleted();\n        }\n      });\n    } catch (err) {\n      observer.onError(err);\n    }\n\n    return function onDispose() {\n      request.abort();\n    };\n  });\n}\n\nfunction makeHTTPDriver() {\n  var _ref2 = arguments.length <= 0 || arguments[0] === undefined ? { autoSubscribe: true } : arguments[0];\n\n  var _ref2$autoSubscribe = _ref2.autoSubscribe;\n  var autoSubscribe = _ref2$autoSubscribe === undefined ? true : _ref2$autoSubscribe;\n\n  return function httpDriver(request$) {\n    var response$$ = request$.map(function (reqOptions) {\n      var response$ = createResponse$(reqOptions);\n      if (autoSubscribe) {\n        response$ = response$.replay(null, 1);\n        response$.connect();\n      }\n      response$.request = reqOptions;\n      return response$;\n    });\n    if (autoSubscribe) {\n      response$$ = response$$.replay(null, 1);\n      response$$.connect();\n    }\n    return response$$;\n  };\n}\n\nmodule.exports = {\n  optionsToSuperagent: optionsToSuperagent,\n  urlToSuperagent: urlToSuperagent,\n  createResponse$: createResponse$,\n\n  makeHTTPDriver: makeHTTPDriver\n};"]}