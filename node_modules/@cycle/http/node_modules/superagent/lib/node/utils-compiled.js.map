{"version":3,"sources":["utils.js"],"names":[],"mappings":"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","file":"utils-compiled.js","sourcesContent":["\n/**\n * Module dependencies.\n */\n\nvar StringDecoder = require('string_decoder').StringDecoder;\nvar Stream = require('stream');\nvar zlib;\n\n/**\n * Require zlib module for Node 0.6+\n */\n\ntry {\n  zlib = require('zlib');\n} catch (e) { }\n\n/**\n * Return the mime type for the given `str`.\n *\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nexports.type = function(str){\n  return str.split(/ *; */).shift();\n};\n\n/**\n * Return header field parameters.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nexports.params = function(str){\n  return str.split(/ *; */).reduce(function(obj, str){\n    var parts = str.split(/ *= */);\n    var key = parts.shift();\n    var val = parts.shift();\n\n    if (key && val) obj[key] = val;\n    return obj;\n  }, {});\n};\n\n/**\n * Parse Link header fields.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nexports.parseLinks = function(str){\n  return str.split(/ *, */).reduce(function(obj, str){\n    var parts = str.split(/ *; */);\n    var url = parts[0].slice(1, -1);\n    var rel = parts[1].split(/ *= */)[1].slice(1, -1);\n    obj[rel] = url;\n    return obj;\n  }, {});\n};\n\n/**\n * Buffers response data events and re-emits when they're unzipped.\n *\n * @param {Request} req\n * @param {Response} res\n * @api private\n */\n\nexports.unzip = function(req, res){\n  if (!zlib) return;\n\n  var unzip = zlib.createUnzip();\n  var stream = new Stream;\n  var decoder;\n\n  // make node responseOnEnd() happy\n  stream.req = req;\n\n  unzip.on('error', function(err){\n    stream.emit('error', err);\n  });\n\n  // pipe to unzip\n  res.pipe(unzip);\n\n  // override `setEncoding` to capture encoding\n  res.setEncoding = function(type){\n    decoder = new StringDecoder(type);\n  };\n\n  // decode upon decompressing with captured encoding\n  unzip.on('data', function(buf){\n    if (decoder) {\n      var str = decoder.write(buf);\n      if (str.length) stream.emit('data', str);\n    } else {\n      stream.emit('data', buf);\n    }\n  });\n\n  unzip.on('end', function(){\n    stream.emit('end');\n  });\n\n  // override `on` to capture data listeners\n  var _on = res.on;\n  res.on = function(type, fn){\n    if ('data' == type || 'end' == type) {\n      stream.on(type, fn);\n    } else if ('error' == type) {\n      stream.on(type, fn);\n      _on.call(res, type, fn);\n    } else {\n      _on.call(res, type, fn);\n    }\n  };\n};\n\n/**\n * Strip content related fields from `header`.\n *\n * @param {Object} header\n * @return {Object} header\n * @api private\n */\n\nexports.cleanHeader = function(header){\n  delete header['content-type'];\n  delete header['content-length'];\n  delete header['transfer-encoding'];\n  delete header['cookie'];\n  delete header['host'];\n  return header;\n};\n"]}