{"version":3,"sources":["test-incoming-form.js"],"names":[],"mappings":"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","file":"test-incoming-form-compiled.js","sourcesContent":["var common = require('../common');\nvar MultipartParserStub = GENTLY.stub('./multipart_parser', 'MultipartParser'),\n    QuerystringParserStub = GENTLY.stub('./querystring_parser', 'QuerystringParser'),\n    EventEmitterStub = GENTLY.stub('events', 'EventEmitter'),\n    StreamStub = GENTLY.stub('stream', 'Stream'),\n    FileStub = GENTLY.stub('./file');\n\nvar formidable = require(common.lib + '/index'),\n    IncomingForm = formidable.IncomingForm,\n    events = require('events'),\n    fs = require('fs'),\n    path = require('path'),\n    Buffer = require('buffer').Buffer,\n    fixtures = require(TEST_FIXTURES + '/multipart'),\n    form,\n    gently;\n\nfunction test(test) {\n  gently = new Gently();\n  gently.expect(EventEmitterStub, 'call');\n  form = new IncomingForm();\n  test();\n  gently.verify(test.name);\n}\n\ntest(function constructor() {\n  assert.strictEqual(form.error, null);\n  assert.strictEqual(form.ended, false);\n  assert.strictEqual(form.type, null);\n  assert.strictEqual(form.headers, null);\n  assert.strictEqual(form.keepExtensions, false);\n  // Can't assume dir === '/tmp' for portability\n  // assert.strictEqual(form.uploadDir, '/tmp');\n  // Make sure it is a directory instead\n  assert.doesNotThrow(function () {\n    assert(fs.statSync(form.uploadDir).isDirectory());\n  });\n  assert.strictEqual(form.encoding, 'utf-8');\n  assert.strictEqual(form.bytesReceived, null);\n  assert.strictEqual(form.bytesExpected, null);\n  assert.strictEqual(form.maxFieldsSize, 2 * 1024 * 1024);\n  assert.strictEqual(form._parser, null);\n  assert.strictEqual(form._flushing, 0);\n  assert.strictEqual(form._fieldsSize, 0);\n  assert.ok(form instanceof EventEmitterStub);\n  assert.equal(form.constructor.name, 'IncomingForm');\n\n  (function testSimpleConstructor() {\n    gently.expect(EventEmitterStub, 'call');\n    var form = IncomingForm();\n    assert.ok(form instanceof IncomingForm);\n  })();\n\n  (function testSimpleConstructorShortcut() {\n    gently.expect(EventEmitterStub, 'call');\n    var form = formidable();\n    assert.ok(form instanceof IncomingForm);\n  })();\n});\n\ntest(function parse() {\n  var REQ = {headers: {}}\n    , emit = {};\n\n  gently.expect(form, 'writeHeaders', function(headers) {\n    assert.strictEqual(headers, REQ.headers);\n  });\n\n  var EVENTS = ['error', 'aborted', 'data', 'end'];\n  gently.expect(REQ, 'on', EVENTS.length, function(event, fn) {\n    assert.equal(event, EVENTS.shift());\n    emit[event] = fn;\n    return this;\n  });\n\n  form.parse(REQ);\n\n  (function testPause() {\n    gently.expect(REQ, 'pause');\n    assert.strictEqual(form.pause(), true);\n  })();\n\n  (function testPauseCriticalException() {\n    form.ended = false;\n\n    var ERR = new Error('dasdsa');\n    gently.expect(REQ, 'pause', function() {\n      throw ERR;\n    });\n\n    gently.expect(form, '_error', function(err) {\n      assert.strictEqual(err, ERR);\n    });\n\n    assert.strictEqual(form.pause(), false);\n  })();\n\n  (function testPauseHarmlessException() {\n    form.ended = true;\n\n    var ERR = new Error('dasdsa');\n    gently.expect(REQ, 'pause', function() {\n      throw ERR;\n    });\n\n    assert.strictEqual(form.pause(), false);\n  })();\n\n  (function testResume() {\n    gently.expect(REQ, 'resume');\n    assert.strictEqual(form.resume(), true);\n  })();\n\n  (function testResumeCriticalException() {\n    form.ended = false;\n\n    var ERR = new Error('dasdsa');\n    gently.expect(REQ, 'resume', function() {\n      throw ERR;\n    });\n\n    gently.expect(form, '_error', function(err) {\n      assert.strictEqual(err, ERR);\n    });\n\n    assert.strictEqual(form.resume(), false);\n  })();\n\n  (function testResumeHarmlessException() {\n    form.ended = true;\n\n    var ERR = new Error('dasdsa');\n    gently.expect(REQ, 'resume', function() {\n      throw ERR;\n    });\n\n    assert.strictEqual(form.resume(), false);\n  })();\n\n  (function testEmitError() {\n    var ERR = new Error('something bad happened');\n    gently.expect(form, '_error',function(err) {\n      assert.strictEqual(err, ERR);\n    });\n    emit.error(ERR);\n  })();\n\n  (function testEmitAborted() {\n    gently.expect(form, 'emit',function(event) {\n      assert.equal(event, 'aborted');\n    });\n    gently.expect(form, '_error');\n\n    emit.aborted();\n  })();\n\n\n  (function testEmitData() {\n    var BUFFER = [1, 2, 3];\n    gently.expect(form, 'write', function(buffer) {\n      assert.strictEqual(buffer, BUFFER);\n    });\n    emit.data(BUFFER);\n  })();\n\n  (function testEmitEnd() {\n    form._parser = {};\n\n    (function testWithError() {\n      var ERR = new Error('haha');\n      gently.expect(form._parser, 'end', function() {\n        return ERR;\n      });\n\n      gently.expect(form, '_error', function(err) {\n        assert.strictEqual(err, ERR);\n      });\n\n      emit.end();\n    })();\n\n    (function testWithoutError() {\n      gently.expect(form._parser, 'end');\n      emit.end();\n    })();\n\n    (function testAfterError() {\n      form.error = true;\n      emit.end();\n    })();\n  })();\n\n  (function testWithCallback() {\n    gently.expect(EventEmitterStub, 'call');\n    var form = new IncomingForm(),\n        REQ = {headers: {}},\n        parseCalled = 0;\n\n    gently.expect(form, 'on', 4, function(event, fn) {\n      if (event == 'field') {\n        fn('field1', 'foo');\n        fn('field1', 'bar');\n        fn('field2', 'nice');\n      }\n\n      if (event == 'file') {\n        fn('file1', '1');\n        fn('file1', '2');\n        fn('file2', '3');\n      }\n\n      if (event == 'end') {\n        fn();\n      }\n      return this;\n    });\n\n    gently.expect(form, 'writeHeaders');\n\n    gently.expect(REQ, 'on', 4, function() {\n      return this;\n    });\n\n    var parseCbOk = function (err, fields, files) {\n      assert.deepEqual(fields, {field1: 'bar', field2: 'nice'});\n      assert.deepEqual(files, {file1: '2', file2: '3'});\n    };\n    form.parse(REQ, parseCbOk);\n\n    var ERR = new Error('test');\n    gently.expect(form, 'on', 3, function(event, fn) {\n      if (event == 'field') {\n        fn('foo', 'bar');\n      }\n\n      if (event == 'error') {\n        fn(ERR);\n        gently.expect(form, 'on');\n        gently.expect(form, 'writeHeaders');\n        gently.expect(REQ, 'on', 4, function() {\n          return this;\n        });\n      }\n      return this;\n    });\n\n    form.parse(REQ, function parseCbErr(err, fields, files) {\n      assert.strictEqual(err, ERR);\n      assert.deepEqual(fields, {foo: 'bar'});\n    });\n  })();\n\n  (function testWriteOrder() {\n    gently.expect(EventEmitterStub, 'call');\n    var form    = new IncomingForm();\n    var REQ     = new events.EventEmitter();\n    var BUF     = {};\n    var DATACB  = null;\n\n    REQ.on('newListener', function(event, fn) {\n      if ('data' === event) fn(BUF);\n    });\n\n    gently.expect(form, 'writeHeaders');\n    gently.expect(form, 'write', function(buf) {\n      assert.strictEqual(buf, BUF);\n    });\n\n    form.parse(REQ);\n  })();\n});\n\ntest(function pause() {\n  assert.strictEqual(form.pause(), false);\n});\n\ntest(function resume() {\n  assert.strictEqual(form.resume(), false);\n});\n\n\ntest(function writeHeaders() {\n  var HEADERS = {};\n  gently.expect(form, '_parseContentLength');\n  gently.expect(form, '_parseContentType');\n\n  form.writeHeaders(HEADERS);\n  assert.strictEqual(form.headers, HEADERS);\n});\n\ntest(function write() {\n  var parser = {},\n      BUFFER = [1, 2, 3];\n\n  form._parser = parser;\n  form.bytesExpected = 523423;\n\n  (function testBasic() {\n    gently.expect(form, 'emit', function(event, bytesReceived, bytesExpected) {\n      assert.equal(event, 'progress');\n      assert.equal(bytesReceived, BUFFER.length);\n      assert.equal(bytesExpected, form.bytesExpected);\n    });\n\n    gently.expect(parser, 'write', function(buffer) {\n      assert.strictEqual(buffer, BUFFER);\n      return buffer.length;\n    });\n\n    assert.equal(form.write(BUFFER), BUFFER.length);\n    assert.equal(form.bytesReceived, BUFFER.length);\n  })();\n\n  (function testParserError() {\n    gently.expect(form, 'emit');\n\n    gently.expect(parser, 'write', function(buffer) {\n      assert.strictEqual(buffer, BUFFER);\n      return buffer.length - 1;\n    });\n\n    gently.expect(form, '_error', function(err) {\n      assert.ok(err.message.match(/parser error/i));\n    });\n\n    assert.equal(form.write(BUFFER), BUFFER.length - 1);\n    assert.equal(form.bytesReceived, BUFFER.length + BUFFER.length);\n  })();\n\n  (function testUninitialized() {\n    delete form._parser;\n\n    gently.expect(form, '_error', function(err) {\n      assert.ok(err.message.match(/unintialized parser/i));\n    });\n    form.write(BUFFER);\n  })();\n});\n\ntest(function parseContentType() {\n  var HEADERS = {};\n\n  form.headers = {'content-type': 'application/x-www-form-urlencoded'};\n  gently.expect(form, '_initUrlencoded');\n  form._parseContentType();\n\n  // accept anything that has 'urlencoded' in it\n  form.headers = {'content-type': 'broken-client/urlencoded-stupid'};\n  gently.expect(form, '_initUrlencoded');\n  form._parseContentType();\n\n  var BOUNDARY = '---------------------------57814261102167618332366269';\n  form.headers = {'content-type': 'multipart/form-data; boundary='+BOUNDARY};\n\n  gently.expect(form, '_initMultipart', function(boundary) {\n    assert.equal(boundary, BOUNDARY);\n  });\n  form._parseContentType();\n\n  (function testQuotedBoundary() {\n    form.headers = {'content-type': 'multipart/form-data; boundary=\"' + BOUNDARY + '\"'};\n\n    gently.expect(form, '_initMultipart', function(boundary) {\n      assert.equal(boundary, BOUNDARY);\n    });\n    form._parseContentType();\n  })();\n\n  (function testNoBoundary() {\n    form.headers = {'content-type': 'multipart/form-data'};\n\n    gently.expect(form, '_error', function(err) {\n      assert.ok(err.message.match(/no multipart boundary/i));\n    });\n    form._parseContentType();\n  })();\n\n  (function testNoContentType() {\n    form.headers = {};\n\n    gently.expect(form, '_error', function(err) {\n      assert.ok(err.message.match(/no content-type/i));\n    });\n    form._parseContentType();\n  })();\n\n  (function testUnknownContentType() {\n    form.headers = {'content-type': 'invalid'};\n\n    gently.expect(form, '_error', function(err) {\n      assert.ok(err.message.match(/unknown content-type/i));\n    });\n    form._parseContentType();\n  })();\n});\n\ntest(function parseContentLength() {\n  var HEADERS = {};\n\n  form.headers = {};\n  gently.expect(form, 'emit', function(event, bytesReceived, bytesExpected) {\n    assert.equal(event, 'progress');\n    assert.equal(bytesReceived, 0);\n    assert.equal(bytesExpected, 0);\n  });\n  form._parseContentLength();\n\n  form.headers['content-length'] = '8';\n  gently.expect(form, 'emit', function(event, bytesReceived, bytesExpected) {\n    assert.equal(event, 'progress');\n    assert.equal(bytesReceived, 0);\n    assert.equal(bytesExpected, 8);\n  });\n  form._parseContentLength();\n  assert.strictEqual(form.bytesReceived, 0);\n  assert.strictEqual(form.bytesExpected, 8);\n\n  // JS can be evil, lets make sure we are not\n  form.headers['content-length'] = '08';\n  gently.expect(form, 'emit', function(event, bytesReceived, bytesExpected) {\n    assert.equal(event, 'progress');\n    assert.equal(bytesReceived, 0);\n    assert.equal(bytesExpected, 8);\n  });\n  form._parseContentLength();\n  assert.strictEqual(form.bytesExpected, 8);\n});\n\ntest(function _initMultipart() {\n  var BOUNDARY = '123',\n      PARSER;\n\n  gently.expect(MultipartParserStub, 'new', function() {\n    PARSER = this;\n  });\n\n  gently.expect(MultipartParserStub.prototype, 'initWithBoundary', function(boundary) {\n    assert.equal(boundary, BOUNDARY);\n  });\n\n  form._initMultipart(BOUNDARY);\n  assert.equal(form.type, 'multipart');\n  assert.strictEqual(form._parser, PARSER);\n\n  (function testRegularField() {\n    var PART;\n    gently.expect(StreamStub, 'new', function() {\n      PART = this;\n    });\n\n    gently.expect(form, 'onPart', function(part) {\n      assert.strictEqual(part, PART);\n      assert.deepEqual\n        ( part.headers\n        , { 'content-disposition': 'form-data; name=\"field1\"'\n          , 'foo': 'bar'\n          }\n        );\n      assert.equal(part.name, 'field1');\n\n      var strings = ['hello', ' world'];\n      gently.expect(part, 'emit', 2, function(event, b) {\n          assert.equal(event, 'data');\n          assert.equal(b.toString(), strings.shift());\n      });\n\n      gently.expect(part, 'emit', function(event, b) {\n          assert.equal(event, 'end');\n      });\n    });\n\n    PARSER.onPartBegin();\n    PARSER.onHeaderField(new Buffer('content-disposition'), 0, 10);\n    PARSER.onHeaderField(new Buffer('content-disposition'), 10, 19);\n    PARSER.onHeaderValue(new Buffer('form-data; name=\"field1\"'), 0, 14);\n    PARSER.onHeaderValue(new Buffer('form-data; name=\"field1\"'), 14, 24);\n    PARSER.onHeaderEnd();\n    PARSER.onHeaderField(new Buffer('foo'), 0, 3);\n    PARSER.onHeaderValue(new Buffer('bar'), 0, 3);\n    PARSER.onHeaderEnd();\n    PARSER.onHeadersEnd();\n    PARSER.onPartData(new Buffer('hello world'), 0, 5);\n    PARSER.onPartData(new Buffer('hello world'), 5, 11);\n    PARSER.onPartEnd();\n  })();\n\n  (function testFileField() {\n    var PART;\n    gently.expect(StreamStub, 'new', function() {\n      PART = this;\n    });\n\n    gently.expect(form, 'onPart', function(part) {\n      assert.deepEqual\n        ( part.headers\n        , { 'content-disposition': 'form-data; name=\"field2\"; filename=\"C:\\\\Documents and Settings\\\\IE\\\\Must\\\\Die\\\\Sun\"et.jpg\"'\n          , 'content-type': 'text/plain'\n          }\n        );\n      assert.equal(part.name, 'field2');\n      assert.equal(part.filename, 'Sun\"et.jpg');\n      assert.equal(part.mime, 'text/plain');\n\n      gently.expect(part, 'emit', function(event, b) {\n        assert.equal(event, 'data');\n        assert.equal(b.toString(), '... contents of file1.txt ...');\n      });\n\n      gently.expect(part, 'emit', function(event, b) {\n          assert.equal(event, 'end');\n      });\n    });\n\n    PARSER.onPartBegin();\n    PARSER.onHeaderField(new Buffer('content-disposition'), 0, 19);\n    PARSER.onHeaderValue(new Buffer('form-data; name=\"field2\"; filename=\"C:\\\\Documents and Settings\\\\IE\\\\Must\\\\Die\\\\Sun\"et.jpg\"'), 0, 85);\n    PARSER.onHeaderEnd();\n    PARSER.onHeaderField(new Buffer('Content-Type'), 0, 12);\n    PARSER.onHeaderValue(new Buffer('text/plain'), 0, 10);\n    PARSER.onHeaderEnd();\n    PARSER.onHeadersEnd();\n    PARSER.onPartData(new Buffer('... contents of file1.txt ...'), 0, 29);\n    PARSER.onPartEnd();\n  })();\n\n  (function testEnd() {\n    gently.expect(form, '_maybeEnd');\n    PARSER.onEnd();\n    assert.ok(form.ended);\n  })();\n});\n\ntest(function _fileName() {\n  // TODO\n  return;\n});\n\ntest(function _initUrlencoded() {\n  var PARSER;\n\n  gently.expect(QuerystringParserStub, 'new', function() {\n    PARSER = this;\n  });\n\n  form._initUrlencoded();\n  assert.equal(form.type, 'urlencoded');\n  assert.strictEqual(form._parser, PARSER);\n\n  (function testOnField() {\n    var KEY = 'KEY', VAL = 'VAL';\n    gently.expect(form, 'emit', function(field, key, val) {\n      assert.equal(field, 'field');\n      assert.equal(key, KEY);\n      assert.equal(val, VAL);\n    });\n\n    PARSER.onField(KEY, VAL);\n  })();\n\n  (function testOnEnd() {\n    gently.expect(form, '_maybeEnd');\n\n    PARSER.onEnd();\n    assert.equal(form.ended, true);\n  })();\n});\n\ntest(function _error() {\n  var ERR = new Error('bla');\n\n  gently.expect(form, 'pause');\n  gently.expect(form, 'emit', function(event, err) {\n    assert.equal(event, 'error');\n    assert.strictEqual(err, ERR);\n  });\n\n  form._error(ERR);\n  assert.strictEqual(form.error, ERR);\n\n  // make sure _error only does its thing once\n  form._error(ERR);\n});\n\ntest(function onPart() {\n  var PART = {};\n  gently.expect(form, 'handlePart', function(part) {\n    assert.strictEqual(part, PART);\n  });\n\n  form.onPart(PART);\n});\n\ntest(function handlePart() {\n  (function testUtf8Field() {\n    var PART = new events.EventEmitter();\n    PART.name = 'my_field';\n\n    gently.expect(form, 'emit', function(event, field, value) {\n      assert.equal(event, 'field');\n      assert.equal(field, 'my_field');\n      assert.equal(value, 'hello world: â‚¬');\n    });\n\n    form.handlePart(PART);\n    PART.emit('data', new Buffer('hello'));\n    PART.emit('data', new Buffer(' world: '));\n    PART.emit('data', new Buffer([0xE2]));\n    PART.emit('data', new Buffer([0x82, 0xAC]));\n    PART.emit('end');\n  })();\n\n  (function testBinaryField() {\n    var PART = new events.EventEmitter();\n    PART.name = 'my_field2';\n\n    gently.expect(form, 'emit', function(event, field, value) {\n      assert.equal(event, 'field');\n      assert.equal(field, 'my_field2');\n      assert.equal(value, 'hello world: '+new Buffer([0xE2, 0x82, 0xAC]).toString('binary'));\n    });\n\n    form.encoding = 'binary';\n    form.handlePart(PART);\n    PART.emit('data', new Buffer('hello'));\n    PART.emit('data', new Buffer(' world: '));\n    PART.emit('data', new Buffer([0xE2]));\n    PART.emit('data', new Buffer([0x82, 0xAC]));\n    PART.emit('end');\n  })();\n\n  (function testFieldSize() {\n    form.maxFieldsSize = 8;\n    var PART = new events.EventEmitter();\n    PART.name = 'my_field';\n\n    gently.expect(form, '_error', function(err) {\n      assert.equal(err.message, 'maxFieldsSize exceeded, received 9 bytes of field data');\n    });\n\n    form.handlePart(PART);\n    form._fieldsSize = 1;\n    PART.emit('data', new Buffer(7));\n    PART.emit('data', new Buffer(1));\n  })();\n\n  (function testFilePart() {\n    var PART = new events.EventEmitter(),\n        FILE = new events.EventEmitter(),\n        PATH = '/foo/bar';\n\n    PART.name = 'my_file';\n    PART.filename = 'sweet.txt';\n    PART.mime = 'sweet.txt';\n\n    gently.expect(form, '_uploadPath', function(filename) {\n      assert.equal(filename, PART.filename);\n      return PATH;\n    });\n\n    gently.expect(FileStub, 'new', function(properties) {\n      assert.equal(properties.path, PATH);\n      assert.equal(properties.name, PART.filename);\n      assert.equal(properties.type, PART.mime);\n      FILE = this;\n\n      gently.expect(form, 'emit', function (event, field, file) {\n        assert.equal(event, 'fileBegin');\n        assert.strictEqual(field, PART.name);\n        assert.strictEqual(file, FILE);\n      });\n\n      gently.expect(FILE, 'open');\n    });\n\n    form.handlePart(PART);\n    assert.equal(form._flushing, 1);\n\n    var BUFFER;\n    gently.expect(form, 'pause');\n    gently.expect(FILE, 'write', function(buffer, cb) {\n      assert.strictEqual(buffer, BUFFER);\n      gently.expect(form, 'resume');\n      // @todo handle cb(new Err)\n      cb();\n    });\n\n    PART.emit('data', BUFFER = new Buffer('test'));\n\n    gently.expect(FILE, 'end', function(cb) {\n      gently.expect(form, 'emit', function(event, field, file) {\n        assert.equal(event, 'file');\n        assert.strictEqual(file, FILE);\n      });\n\n      gently.expect(form, '_maybeEnd');\n\n      cb();\n      assert.equal(form._flushing, 0);\n    });\n\n    PART.emit('end');\n  })();\n});\n\ntest(function _uploadPath() {\n  (function testUniqueId() {\n    var UUID_A, UUID_B;\n    gently.expect(GENTLY.hijacked.path, 'join', function(uploadDir, uuid) {\n      assert.equal(uploadDir, form.uploadDir);\n      UUID_A = uuid;\n    });\n    form._uploadPath();\n\n    gently.expect(GENTLY.hijacked.path, 'join', function(uploadDir, uuid) {\n      UUID_B = uuid;\n    });\n    form._uploadPath();\n\n    assert.notEqual(UUID_A, UUID_B);\n  })();\n\n  (function testFileExtension() {\n    form.keepExtensions = true;\n    var FILENAME = 'foo.jpg',\n        EXT = '.bar';\n\n    gently.expect(GENTLY.hijacked.path, 'extname', function(filename) {\n      assert.equal(filename, FILENAME);\n      gently.restore(path, 'extname');\n\n      return EXT;\n    });\n\n    gently.expect(GENTLY.hijacked.path, 'join', function(uploadDir, name) {\n      assert.equal(path.extname(name), EXT);\n    });\n    form._uploadPath(FILENAME);\n  })();\n});\n\ntest(function _maybeEnd() {\n  gently.expect(form, 'emit', 0);\n  form._maybeEnd();\n\n  form.ended = true;\n  form._flushing = 1;\n  form._maybeEnd();\n\n  gently.expect(form, 'emit', function(event) {\n    assert.equal(event, 'end');\n  });\n\n  form.ended = true;\n  form._flushing = 0;\n  form._maybeEnd();\n});\n"]}